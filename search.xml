<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[centos容器镜像跑consul集群]]></title>
    <url>%2F2018%2F12%2F02%2Fcentos%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E8%B7%91consul%E9%9B%86%E7%BE%A4%2F</url>
    <content type="text"><![CDATA[docker相关命令1234567891011121314获取dockerhub镜像(不带版本拉取lastest)docker pull centos:&lt;version&gt;创建docker镜像docker build -t mydocker:0.1 .查看当前镜像docker image ls运行容器docker run -it -d --privileged=true -p 8501:8500 mydocker:0.1 /usr/sbin/init查看容器docker ps -a 安装docker-ce根据系统版本选择合适的docker-ce版本，最新的docker-ce版本可能不适配老的centos版本。 查看docker-ce可用版本： 12345678910111213141516171819202122232425[root@localhost ~]# yum list docker-ce --showduplicates | sort -r已加载插件：fastestmirror已安装的软件包可安装的软件包 * updates: mirrors.cqu.edu.cnLoading mirror speeds from cached hostfile * extras: mirror.bit.edu.cndocker-ce.x86_64 3:18.09.0-3.el7 docker-ce-stabledocker-ce.x86_64 3:18.09.0-3.el7 @docker-ce-stabledocker-ce.x86_64 18.06.1.ce-3.el7 docker-ce-stabledocker-ce.x86_64 18.06.0.ce-3.el7 docker-ce-stabledocker-ce.x86_64 18.03.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 18.03.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.12.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.12.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.09.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.09.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.06.2.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.06.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.06.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.03.3.ce-1.el7 docker-ce-stabledocker-ce.x86_64 17.03.2.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.03.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.03.0.ce-1.el7.centos docker-ce-stable * base: mirrors.cqu.edu.cn 安装docker-ce： 1yum install docker-ce 启动docker： 1systemctl start docker 设置开机启动： 1systemctl enable docker 参考：&lt;Get Docker CE for CentOS | Docker Documentation&gt; Dockerfilebase Dockerfile 根据centos镜像安装基础软件制作基础镜像: 123456789101112131415161718192021222324FROM centosRUN mkdir -p /etc/yum.repos.d/repo.bak/ &amp;&amp; \ mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/repo.bak/COPY repo/CentOS7-Base-163.repo /etc/yum.repos.d/COPY repo/Centos-7.repo /etc/yum.repos.d/RUN yum clean all &amp;&amp; \ yum makecache &amp;&amp; \ yum install -y epel-releaseCOPY repo/epel-7.repo /etc/yum.repos.d/RUN yum clean all &amp;&amp; \ yum makecacheRUN yum install -y net-tools &amp;&amp;\ yum install -y iproute &amp;&amp; \ yum install -y unzip &amp;&amp; \ yum install -y vimCOPY conf/.vimrc /root/RUN alias vi=vim 参考：CentOS7系统配置国内yum源和epel源 根据定制的基础镜像安装业务镜像： 123456789101112131415161718FROM mybase:0.1COPY pkg/consul_1.4.0_linux_amd64.zip /homeRUN cd /home &amp;&amp; \ unzip /home/consul_1.4.0_linux_amd64.zip &amp;&amp; \ mv /home/consul /usr/local/binCOPY pkg/start.sh /homeCOPY pkg/test_consul.service /usr/lib/systemd/system/RUN chmod 644 /usr/lib/systemd/system/test_consul.service &amp;&amp; \ systemctl enable test_consul.serviceEXPOSE 8500CMD [&quot;/usr/sbin/init&quot;] 参考：Centos7下Rinetd安装与应用, linux rinetd 端口转发部署 安装并自动运行consul配置systemctl系统服务 1234567891011[UNIT]Description=Test Consul[Service]Type=oneshotRemainAfterExit=trueExecStart=/bin/bash /home/start.shKillMode=process[Install]WantedBy=multi-user.target 启动脚本 123456#!/bin/bashlocal_ip=$(ifconfig | grep -oP &quot;172.17.0.\d&#123;0,3&#125;&quot;)consul agent -server -bootstrap-expect=3 -data-dir=/tmp/consul -node=$&#123;local_ip&#125; -bind=$&#123;local_ip&#125; -datacenter=dc1 -client=0.0.0.0 -ui &gt;&gt; /home/start.log 2&gt;&amp;1 &amp;sleep 20consul join $&#123;local_ip&#125; 查看consul集群 12345[root@localhost ~]# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES9bb07c7d4b3a mydocker:1.0 &quot;/usr/sbin/init&quot; 3 days ago Up 3 minutes 0.0.0.0:8502-&gt;8500/tcp consul_0.2caca6a79a152 mydocker:1.0 &quot;/usr/sbin/init&quot; 3 days ago Up 3 minutes 0.0.0.0:8501-&gt;8500/tcp consul_0.370e3e2f90afb mydocker:1.0 &quot;/usr/sbin/init&quot; 3 days ago Up 3 minutes 0.0.0.0:8500-&gt;8500/tcp consul_0.4 consul UI 使用docker-compose编排容器安装dockercompose 123456[root@localhost ~]# curl -L &quot;https://github.com/docker/compose/releases/download/1.23.1/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose[root@localhost ~]# chmod +x /usr/local/bin/docker-compose[root@localhost ~]# docker-compose --versiondocker-compose version 1.23.2, build 1110ad01 参考：Install Docker Compose | Docker Documentation 根据场景编写docker-compose.yml 12345678910111213141516171819202122232425262728293031323334353637version: &apos;3&apos;services: consul_1: image: mydocker:1.0 container_name: docker_consul_1 hostname: consul_1 environment: - TZ=Asia/Shanghai ports: - 8501:8500 privileged: true tty: true command: /usr/sbin/init consul_2: image: mydocker:1.0 container_name: docker_consul_2 hostname: consul_2 environment: - TZ=Asia/Shanghai ports: - 8502:8500 privileged: true tty: true command: /usr/sbin/init consul_3: image: mydocker:1.0 container_name: docker_consul_3 hostname: consul_3 environment: - TZ=Asia/Shanghai ports: - 8503:8500 privileged: true tty: true command: /usr/sbin/init 启动容器 12345[root@localhost compose_consul]# docker-compose up -dCreating network &quot;compose_consul_default&quot; with the default driverCreating docker_consul_2 ... doneCreating docker_consul_1 ... doneCreating docker_consul_3 ... done 停止并删除容器 12345678[root@localhost compose_consul]# docker-compose downStopping docker_consul_1 ... doneStopping docker_consul_2 ... doneStopping docker_consul_3 ... doneRemoving docker_consul_1 ... doneRemoving docker_consul_2 ... doneRemoving docker_consul_3 ... doneRemoving network compose_consul_default 查看 123456[root@localhost compose_consul]# docker-compose ps Name Command State Ports-----------------------------------------------------------------docker_consul_1 /usr/sbin/init Up 0.0.0.0:8501-&gt;8500/tcpdocker_consul_2 /usr/sbin/init Up 0.0.0.0:8502-&gt;8500/tcpdocker_consul_3 /usr/sbin/init Up 0.0.0.0:8503-&gt;8500/tcp]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>consul</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[idea快捷键]]></title>
    <url>%2F2018%2F11%2F11%2Fidea%E5%BF%AB%E6%8D%B7%E9%94%AE%2F</url>
    <content type="text"><![CDATA[简介记录idea系ide的快捷键 快捷键集快捷键基于Default修改1Keymap -&gt; Duplicate -&gt; Default copy for me 搜索1Ctrl + Shift + F]]></content>
      <categories>
        <category>idea</category>
      </categories>
      <tags>
        <tag>idea 快捷键</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[idea配置]]></title>
    <url>%2F2018%2F11%2F11%2Fidea%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[简介记录idea系配置 配置集配置页面(以下配置无特殊说明均是该页面)12菜单路径: File -&gt; Settings快捷键: Ctrl + Alt + S 修改字体大小12Editor -&gt; Font等宽字体: Courier New 字体大小滚轮调节1Editor -&gt; General -&gt; Change font size (Zoom) with Ctrl+Mouse Wheel]]></content>
      <categories>
        <category>idea</category>
      </categories>
      <tags>
        <tag>idea</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[software]]></title>
    <url>%2F2018%2F11%2F07%2Fsoftware%2F</url>
    <content type="text"><![CDATA[简介记录窗口下那些用过的软件。 软件集合 编辑器 notepad++ 文本编辑器，各种插件，可深度定制； gvim 好用 vscode windwos推出的诚意之作 Atom github出品 浏览器 chrome google firefox ide JetBrains CLion c编辑器 Source Insight c编辑器 Intellij IDEA java编辑器 JetBrains PyCharm python编辑器 流程图 visio EA (Enterprise Architect) Markdown Typora Markdown Pad 效率工具 snipaste 截图工具 Everything 搜索工具 WGestures 鼠标手势工具 autohotkey 自定义工具 capslock++ 自定义capslock工具 beyondcompare 文本文件夹对比工具 clover windows文件夹整合工具 ConEmu windows cmd 替代工具 cmder 封装ConEmu MDIE 多窗口 Q-Dir 多窗口 Total Command FileLocator 文件文本搜索工具 SSH工具 putty xshell FTP工具 xftp filezilla xlight winscp 虚拟化 VirtualBox VMware 通讯工具 TIM QQ 钉钉 飞鸽 笔记工具 boogu 树形 onenote office ediary 为知 (wiz) 收费了 keynote 播放器 vlc kmplayer 思维导图 xmind MindManager 网络工具 Fiddler 抓包工具 代码管理 git svn 下载软件 迅雷 utorrent]]></content>
      <categories>
        <category>软件</category>
      </categories>
      <tags>
        <tag>软件</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vim]]></title>
    <url>%2F2018%2F11%2F07%2Fvim%2F</url>
    <content type="text"><![CDATA[简介VIM常用操作记录 VIM操作小结 跳转到指定行12行号 + gg:行号 + Enter]]></content>
      <categories>
        <category>vim</category>
      </categories>
      <tags>
        <tag>vim</tag>
      </tags>
  </entry>
</search>
